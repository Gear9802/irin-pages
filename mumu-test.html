<!DOCTYPE HTML>
<!--
	Landed by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>มูมู่  แมวน้อยของไอริน</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="ระบบสอนศัพท์ของมูมู่" />
		<meta name="keywords" content="" />
        <link rel="shortcut icon" href="images/favicon-64.ico">
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.scrolly.min.js"></script>
		<script src="js/jquery.dropotron.min.js"></script>
		<script src="js/jquery.scrollex.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-xlarge.css" />
		</noscript>
		<!--[if lte IE 9]><link rel="stylesheet" href="css/ie/v9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
		<script>
			window.fbAsyncInit = function() {
				FB.init({
					appId      : '644049662391131',
					xfbml      : true,
					version    : 'v2.2'
				});
				FB.getLoginStatus(function(response) {
					if (response.status === 'connected') {
                        $(function() {
                            $("#login-display").hide();
                            $("#content-display").show();
                        });
                        sessionStorage.token = response.authResponse.accessToken;
                        loadHistory();
                        loadUnknown();
					}
				});
			};
			(function(d, s, id){
				var js, fjs = d.getElementsByTagName(s)[0];
				if (d.getElementById(id)) {return;}
				js = d.createElement(s); js.id = id;
				js.src = "//connect.facebook.net/th_TH/sdk.js";
				fjs.parentNode.insertBefore(js, fjs);
			}(document, 'script', 'facebook-jssdk'));
			var fb_login = function(){
				FB.login(function(){
					FB.getLoginStatus(function(response) {
						if (response.status === 'connected') {
							$(function() {
                                $("#login-display").hide();
                                $("#content-display").show();
                            });
                            sessionStorage.token = response.authResponse.accessToken;
                            loadHistory();
                            loadUnknown();
						}
					});
				}, {scope: ''});
			}
            var history_shift = 0;
            var history_page = 0;
            var history_id_roll = 0;
            var loadHistory = function(){
                history_page++;
                $.get("https://mumu.irin.in.th/history?access_token="+sessionStorage.token+"&limit="+(((history_page-1)*10)+history_shift)+",10",function(r){
                    if(r.length==0){
                        $("#history-loadmore").remove();
                        if(history_page==1){
                            $("#history-spinner").append("<tr class='history-nothing'><td colspan='3'>คุณยังไม่ได้สอนศัพท์เลย ช่วยสอนเพิ่มด้วย</td></tr>");        
                        }
                    }
                    r.forEach(function(q){
                        var add_date = new Date(q.ADD_DATE);
                        $("#history-display").append("<tr id='HISTORY_"+addslashes(q.INPUT)+"_"+addslashes(q.REPLY)+"'><td>"+q.INPUT+"</td><td><a id='REPLY_"+(history_id_roll)+"' style='color:white;' href=\"javascript:historyEdit('"+addslashes(q.INPUT)+"','"+addslashes(q.REPLY)+"','"+history_id_roll+"')\">"+q.REPLY+"</a></td><td>"+zerogap(add_date.getDate())+"/"+zerogap(add_date.getMonth())+"/"+(add_date.getFullYear()+543)+" "+zerogap(add_date.getHours())+":"+zerogap(add_date.getMinutes())+"</td></tr>");
                        history_id_roll++;
                    });
                    $("#history-spinner").remove();
                });
            }
            var historyEdit = function(input,reply,id_roll){
                $("#REPLY_"+id_roll).replaceWith("<input type='text' id='REPLYBOX_"+id_roll+"' value='"+reply+"'/>");
                $("#REPLYBOX_"+id_roll).focus();
                $("#REPLYBOX_"+id_roll).focusout(function(){
                    var txt = $(this).val();
                    $.post("https://mumu.irin.in.th/edit",{input:input,reply:txt,old:reply,access_token:sessionStorage.token},function(){
                    
                    }).error(function(errr){
                        console.log(err);
                        alert("เซิฟเวอร์ขัดข้อง โปรดแจ้งปัญหาที่ที่เพจ pure's app");
                    });
                    $(this).replaceWith("<a id='REPLY_"+(id_roll)+"' style='color:white;' href=\"javascript:historyEdit('"+addslashes(input)+"','"+addslashes(txt)+"','"+id_roll+"')\">"+txt+"</a>");
                });
            }
            var clickloadHistory = function(){
                $("#history-display").append("<tr id=\"history-spinner\"><td colspan=\"3\"><center><i class=\"fa fa-circle-o-notch fa-spin\"></i></center></td></tr>");
                loadHistory();
            }
            var isUnknownloaded = false;
            var unknwon_id_roll = 0;
            var loadUnknown = function(){
                $.get("https://mumu.irin.in.th/unknown?limit=12",function(r){
                    $("#unknown-loadmore").remove();
                    if(isUnknownloaded==false){
                        console.log("System pop");
                        isUnknownloaded = true;
                        r.pop();
                    }
                    r.forEach(function(q){
                        $("#unknown-display").append("<div id=\"UNKNOWN_"+(unknwon_id_roll)+"\" class=\"2u 3u(medium) 4u(small) 6u(xsmall)\"><a href=\"javascript:clickUnknown('"+addslashes(q.INPUT)+"','"+(unknwon_id_roll)+"');\" style=\"color:white;\">"+q.INPUT+"</a></div>");
                        unknwon_id_roll++;
                    });
                    $("#unknown-display").append("<div id=\"unknown-loadmore\" class=\"2u 3u(medium) 4u(small) 6u(xsmall)\"><a href=\"javascript:clickloadUnknown();\">เพิ่มเติม...</a></div>");
                });
            }
            var clickUnknown = function(msg,id){
                $("#txt_input").val(msg);
                $('html,body').animate({scrollTop: $("#content-display").offset().top-70},'fast');
                $.get("https://mumu.irin.in.th/unknown?limit=1",function(r){
                    $("#UNKNOWN_"+id).remove();
                    $("#unknown-loadmore").remove();
                    r.forEach(function(q){
                        $("#unknown-display").append("<div id=\"UNKNOWN_"+(unknwon_id_roll)+"\" class=\"2u 3u(medium) 4u(small) 6u(xsmall)\"><a href=\"javascript:clickUnknown('"+q.INPUT+"','"+(unknwon_id_roll)+"');\" style=\"color:white;\">"+q.INPUT+"</a></div>");
                        unknwon_id_roll++;
                    });
                    $("#unknown-display").append("<div id=\"unknown-loadmore\" class=\"2u 3u(medium) 4u(small) 6u(xsmall)\"><a href=\"javascript:clickloadUnknown();\">เพิ่มเติม...</a></div>");
                });                
            }
            var clickloadUnknown = function(){
                $("#unknown-loadmore").html("<i class=\"fa fa-circle-o-notch fa-spin\"></i>");
                $("#unknown-loadmore").css("color:white;");
                loadUnknown();
            }
            var zerogap = function(v){
                return (v<10)?"0"+v:v;
            }
            var addword = function(){
                var cin = $("#txt_input").val();
                var cout = $("#txt_reply").val();
                $("#txt_input").val("");
                $("#txt_reply").val("");
                $.post("https://mumu.irin.in.th/teach",{input:cin,reply:cout,access_token:sessionStorage.token},function(){
                    var add_date = new Date(); 
                    if($("#history-nothing").length){
                        $("#history-nothing").remove();
                    }
                    $("#history-display").prepend("<tr><td>"+cin+"</td><td><a id='REPLY_"+(history_id_roll)+"' style='color:white;' href=\"javascript:historyEdit('"+addslashes(cin)+"','"+addslashes(cout)+"','"+history_id_roll+"')\">"+cout+"</a></td><td>"+zerogap(add_date.getDate())+"/"+zerogap(add_date.getMonth())+"/"+(add_date.getFullYear()+543)+" "+zerogap(add_date.getHours())+":"+zerogap(add_date.getMinutes())+"</td></tr>");
                    history_id_roll++;
                    history_shift++;
                    $('#addwordcomplete').stop().fadeIn(400).delay(3000).fadeOut(400);

                }).fail(function(e){
                    alert("เซิฟเวอร์ขัดข้อง แจ้งเราทราบทางแฟนเพจ pure's app");
                    console.log(e);
                });
            }
            function addslashes( str ) {
                return (str + '').replace(/[\\"']/g, '\\$&').replace(/\u0000/g, '\\0');
            }
		</script>
        <style>
            .toast {
                height:auto;
                width:180px;
                position:fixed;
                left:50%;
                margin-left:-90px;
                bottom:30px;
                background-color: #383838;
                color: #F0F0F0;
                padding:10px;
                text-align:center;
                border-radius: 2px;
                -webkit-box-shadow: 0px 0px 10px -1px rgba(56, 56, 56, 1);
                -moz-box-shadow: 0px 0px 10px -1px rgba(56, 56, 56, 1);
                box-shadow: 0px 0px 10px -1px rgba(56, 56, 56, 1);
                z-index: 1000;
            }
        </style>
	</head>
	<body>

        <!-- Header -->
			<header id="header">
				<h1 id="logo"><a href="/">ไอริน</a></h1>
				<nav id="nav">
					<ul>
						<li>
                            <a href="#">คุยกับ...</a>
                            <ul>
                                <li><a href="https://web.irin.in.th/">ไอริน</a></li>
								<li><a href="https://www.facebook.com/1376575142661760">มูมู่</a></li>
				            </ul>
                        </li>
						<li>
							<a href="">เรียนรู้</a>
							<ul>
								<li><a href="rivescript">วิธีการใช้ Rivescript</a></li>
								<li><a href="integrate">ใช้ไอรินบนแอปของคุณ</a></li>
								<li><a href="botmanager">วิธีการใช้ตัวจัดการบอท</a></li>
							</ul>
						</li>
						<li><a href="mumu">สอนมูมู่</a></li>
						<li><a href="service" class="button special">สร้างบอท</a></li>
					</ul>
				</nav>
			</header>

		<!-- Main -->
			<div id="main" class="wrapper style1">
				<div class="container">
					<header class="major">
						<h2>มูมู่ แมวน้อยของไอริน</h2>
						<p>สร้างขึ้นมาเพื่อพัฒนาฐานข้อมูลของไอรินได้เร็วขึ้น</p>
					</header>

					<!-- Content -->
						<section id="login-display">
                            <center>
                                <div class="3u 6u(small) 12u(xsmall)">
                                    <a href="javascript:fb_login();" class="button special fit">เริ่มต้นสอนมูมู่</a>
                                <div>
                            </center>
						</section>
                        <div id="content-display" style="display:none;">
                            <section>
                                    <center>
                                        <h3>สอนศัพท์ใหม่</h3>
                                        <div class="6u 9u(medium) 12(small) 12u(xsmall)">
                                            <input type="text" name="txt_input" id="txt_input" value="" placeholder="คำศัพท์" style="background-color:#2D2E36">
                                        </div>
                                        <div class="6u 9u(medium) 12(small) 12u(xsmall)">
                                            <input type="text" name="txt_reply" id="txt_reply" value="" placeholder="ให้ตอบว่า" style="background-color:#2D2E36">
                                        </div>
                                        <div class="3u 3u(medium) 4u(small) 12u(xsmall)" style="margin-top:20px;">
                                            <a href="javascript:addword();" class="button special fit">เพิ่มศัพท์ใหม่</a>
                                        </div>
                                </center>
                            </section>
                            <hr/>
                            <section>
                                <center>
                                    <h3>ศัพท์ที่มูมู่ไม่รู้จัก</h3>
                                </center>
                                <center>
                                    <div id="unknown-display" class="row">
                                    </div>
                                </center>
                            </section>
                            <hr/>
                            <section>
                                    <center>
                                        <h3>ประโยคที่สอนโดยฉัน</h3>    
                                    </center>
                                    <table class="alt">
									<thead>
										<tr>
											<th>คำศัพท์</th>
											<th>ตอบว่า</th>
											<th>สอนเมื่อ</th>
										</tr>
									</thead>
									<tbody id="history-display">
                                        <tr id="history-spinner"><td colspan="3"><center><i class="fa fa-circle-o-notch fa-spin"></i></center></td></tr>
									</tbody>
                                    <tfoot>
                                        <tr id="history-loadmore">
                                            <td colspan="3" style="text-align:right;"><a href="javascript:clickloadHistory();">เพิ่มเติม...</a></td>
                                        </tr>
                                    </tfoot>									
								</table>
                            </section>
                        </div>

				</div>
			</div>
            <!-- Hidden Item zone -->
                    <div id='addwordcomplete' class="toast" style='display:none'>เพิ่มคำศัพท์ใหม่เรียบร้อยแล้ว</div>
			<!-- Footer -->
				<footer id="footer">
					<ul class="icons">
						<li><a href="https://www.facebook.com/irinbot" target="_blank" class="icon alt fa-facebook"><span class="label">Facebook</span></a></li>
						<li><a href="https://github.com/pureexe" target="_blank" class="icon alt fa-github"><span class="label">GitHub</span></a></li>
						<li><a href="mailto:dev@irin.in.th" class="icon alt fa-envelope"><span class="label">Email</span></a></li>
					</ul>
					<ul class="copyright">
						<li>&copy; ไอริน. All rights reserved.</li>
						<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						<li>Created : <a href="http://www.pureapp.in.th">Pure's app</a></li>
					</ul>
				</footer>

	</body>
</html>
